{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Donor Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'css/styles.css/navbar.css' %}">
  <link rel="stylesheet" href="{% static 'css/styles.css/index.css' %}">
  <link rel="stylesheet" href="{% static 'css/styles.css/donor.css' %}">
  <link rel="stylesheet" href="{% static 'css/styles.css/donor.js' %}">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=sans-serif:wght@300;500;700&display=swap" rel="stylesheet">
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
  <div class="container">
    <a class="navbar-brand" href="#">
      <img src="{% static 'Images/Our_Logo.png' %}" alt="Logo" width="120">

    </a>
    <span class="navbar-text font-weight-bold text-primary ml-2 h5">Nourished by Joy and Grace</span>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end" id="navbarContent">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="{% url 'homepage' %}">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'about_us' %}">About Us</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'impact' %}">Impact</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'logout' %}">Logout</a></li>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Dashboard Main Content -->
<div class="container dashboard-container">
  <div class="row">
    <!-- Left: Welcome and Actions -->
    <div class="col-lg-6 dashboard-left mb-4 mb-lg-0">
      <h1 class="mb-3">Welcome to Nourished by Joy and Grace Feeding Fund Portal</h1>
        <h3 class="mb-4">Hello, {{ user.full_name|default:user.email }} <span>(Donor)</span>!</h3>
        
      <p>
        Thank you for your generous support! Your contributions help us deliver vital resources to those in need. Explore your giving history, make a new donation, or join our next event to multiply your impact.
      </p>

      {% if messages %}
        {% for message in messages %}
        <div class="alert alert-success">{{ message }}</div>
        {% endfor %}
      {% endif %}
    
      <div class="dashboard-buttons mt-4 d-flex flex-column">
        <a href="{% url 'donation_form' %}" class="btn mb-2 rounded-pill" style="background-color:#007bff; color:white;">Donate Funds</a>
        <a href="{% url 'donor_donation_history' %}" class="btn mb-2 rounded-pill" style="background-color:#28a745; color:white;">View Donation History</a>
        <a href="{% url 'join_an_event' %}" class="btn rounded-pill" style="background-color:#f8f9fa; color:#343a40; border:1px solid #ced4da;">Join an Event</a>
      </div>
    </div>

    <div class="dashboard-img-section">
        <img src="{% static 'Images/thanks-for-your-donations.jpg' %}" alt="Donor Impact" width="500" />
      </div>
    </div>

    <!-- Feeding Report Table Section -->
    <div class="container mt-5">
      <h3 class="mb-4">Recent Feeding Reports</h3>
      <div class="table-responsive shadow rounded">
        <table class="table table-striped table-hover align-middle" id="feedingReportTable">
          <thead class="table-dark">
            <tr>
              <th scope="col">Report Date</th>
              <th scope="col">Meals Received</th>
              <th scope="col">Meals Served</th>
              <th scope="col">Comments</th>
              <th scope="col">School</th>
              <th scope="col">Reported By</th>
            </tr>
          </thead>
          <tbody>
            {% for report in feeding_reports %}
              <tr>
                <td>{{ report.date|date:'M d, Y' }}</td>
                <td>{{ report.meals_received|default:'-' }}</td>
                <td>{{ report.meals_served|default:'-' }}</td>
                <td>{{ report.comments|default:'-' }}</td>
                <td>{{ report.school.school_name|default:'N/A' }}</td>
                <td>{{ report.reported_by.full_name|default:report.reported_by.email }}</td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="6" class="text-center">No feeding reports available.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    
<!-- Footer -->
<footer class="bg-light mt-5 p-3 text-center text-muted">
  &copy; 2025 Nourished by Joy and Grace | Powered by Grace & Joy
</footer>

  <!-- Bootstrap JS (required for navbar toggling) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="styles.css/donor.js"></script>

  <!-- DataTables for Feeding Report Table -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap4.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#feedingReportTable').DataTable({
        paging: true,
        searching: true,
        info: true,
        lengthChange: false,
        pageLength: 5,
        order: [[0, 'desc']],
        language: {
          search: "Filter reports:"
        }
      });
    });
  </script>
</body>
</html>