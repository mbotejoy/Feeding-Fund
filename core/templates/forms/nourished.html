{% load static %}
<!-- tag is used to link to static files like CSS or JS -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nourished by Joy and Grace</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'css/styles.css/navbar.css' %}">
  <link rel="stylesheet" href="{% static 'css/styles.css/index.css' %}">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
</head>

<body>

<!-- ================= NAVBAR ================= -->
<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
  <div class="container">
    <a class="navbar-brand" href="#">
      <img src="{% static 'Images/Our_Logo.png' %}" alt="Logo" width="120">
    </a>
    <span class="navbar-text font-weight-bold text-primary ml-2 h5">Nourished with Joy and Grace</span>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarContent">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="#about">About Us</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'signup' %}">Sign Up</a></li>
        <li class="nav-item"><a class="nav-link" href="#impact">Impact</a></li>
        <li class="nav-item"><a class="nav-link btn btn-outline-success btn-sm ml-2" href="{% url 'give_feedback' %}">Feedback/Contact Us</a></li>

        <!-- Login Dropdown -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle btn btn-outline-secondary btn-sm ml-2" href="#" id="loginDropdown" data-toggle="dropdown">
            Login As
          </a>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="{% url 'donor_dashboard' %}">Donor</a>
            <a class="dropdown-item" href="{% url 'school_admin' %}">School Admin</a>
            <a class="dropdown-item" href="{% url 'parent' %}">Parent</a>
            <a class="dropdown-item" href="{% url 'communityagent_dashboard' %}">Community Agent</a>
          </div>
        </li>
      <ul class="">
        <!-- Logout Button (visible if user is authenticated) -->
        {% if user.is_authenticated %}
          <li class="nav-item ml-3">
        <a class="btn btn-danger btn-sm" href="{% url 'logout' %}">Logout</a>
          </li>
        {% endif %}

      </ul>
      </ul>
    </div>
  </div>
</nav>

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-success">{{ message }}</div>
  {% endfor %}
{% endif %}

<!-- =============== HOME PAGE SECTION =============== -->
<section id="home" class="homepage bg-light">
  <div class="container mt-5">
    <div class="row align-items-center">
      <!-- Left Section: Donation Card -->
      <div class="col-md-6 mb-4">
        <div class="card shadow">
          <img src="{% static 'Images/ChildrenEating.jpeg' %}" class="card-img-top" alt="Children eating" width="120">
          <div class="card-body">
            <h5 class="card-title">Help Feed a Child Today</h5>
            <p class="card-text">Your donation can give a child a healthy start and support their education.</p>
            <!-- Donate Now button triggers modal -->
            <a href="#" class="btn btn-success btn-block" data-toggle="modal" data-target="#mpesaDonationModal">Donate Now</a>
            <!-- MPESA Donation Modal -->
            <div class="modal fade" id="mpesaDonationModal" tabindex="-1" role="dialog" aria-labelledby="mpesaDonationModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <form method="post" action="{% url 'homepage_mpesa_donation' %}">
                    {% csrf_token %}
                    <div class="modal-header">
                      <h5 class="modal-title" id="mpesaDonationModalLabel">MPESA Donation</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <div class="alert alert-info" style="font-size:0.98rem;">
                        <strong>How to Donate via MPESA:</strong><br>
                        1. Open your MPESA menu on your phone.<br>
                        2. Select <strong>Lipa na MPESA</strong> &rarr; <strong>Paybill</strong>.<br>
                        3. Enter our Paybill Number: <strong>170512</strong>.<br>
                        4. For Account, enter  "Donation".<br>
                        5. Enter the amount you wish to donate.<br>
                        6. Complete the payment and copy the MPESA transaction code.<br>
                        7. Fill in the form below with your details and the transaction code.<br>
                      </div>
                      <div class="form-group">
                        <label for="donor_name">Donor Name</label>
                        <input type="text" class="form-control" id="donor_name" name="donor_name" required>
                      </div>
                      <div class="form-group">
                        <label for="amount">Amount (KES)</label>
                        <input type="number" class="form-control" id="amount" name="amount" min="1" required>
                      </div>
                      <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="text" class="form-control" id="phone" name="phone" maxlength="20" required>
                      </div>
                      <div class="form-group">
                        <label for="transaction_code">MPESA Transaction Code</label>
                        <input type="text" class="form-control" id="transaction_code" name="transaction_code" required>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                      <button type="submit" class="btn btn-success">Donate</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Right Section: Mission Statement -->
      <div class="col-md-6">
        <h2 class="text-dark font-weight-bold">Our Mission</h2>
        <p>
          Our mission is to end school hunger by connecting donors, parents, teachers and community agents through a transparent food funding platform. Inspired by our Service Based Learning experience at a public school using Tap2Eat where many children couldn’t afford even one daily meal we set out to build a solution that ensures every child receives consistent, nutritious meals and a fair chance to thrive.
        </p>
        <p>
          Every contribution goes directly to ensuring children are well-fed and able to focus on learning, growing, and thriving.
        </p>
        <div class="d-flex justify-content-center mt-3">
          <a href="#impact" class="btn rounded-pill" style="background-color:#007bff; color:#fff; font-weight:600; padding:12px 36px; font-size:1.1rem;">See Our Impact</a>
              <a href="#events" class="btn rounded-pill ml-2" style="background-color:#007bff; color:#fff; font-weight:600; padding:12px 36px; font-size:1.1rem;">See Upcoming Events</a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- =============== ABOUT US SECTION =============== -->
<section id="about" class="aboutus bg-white">
  <h2 class="mt-3 text-center">About Us</h2>
  <hr>
  <div class="container border rounded p-4 bg-white">
    <div class="row">
      <!-- Left Section: Images and Captions -->
      <div class="col-md-6">
        <div class="row mb-3">
          <div class="col-6">
            <div class="card text-center mb-3">
              <div class="card-header bg-light font-weight-bold">Joy</div>
              <div class="card-body bg-light">
                <img src="{%static 'Images/JoyPhoto.jpg' %}" alt="Joy" class="img-fluid" style="min-height:100px; max-height:120px;">
              </div>
            </div>
          </div>
          <div class="col-6">
            <div class="card text-center mb-3">
              <div class="card-header bg-light font-weight-bold">Grace</div>
              <div class="card-body bg-light">
                <img src="{%static 'Images/PassportPhoto.jpg' %}" alt="Grace" class="img-fluid" style="min-height:100px; max-height:120px;">
              </div>
            </div>
          </div>
        </div>
        <div class="card text-center">
          <div class="card-header bg-light font-weight-bold">Volunteers giving school meals</div>
          <div class="card-body bg-light">
            <img src="{% static 'Images/VolunteersGivingMeals.jpeg' %}" alt="Volunteers" class="img-fluid" style="min-height:100px; max-height:120px;">
          </div>
        </div>
      </div>
      <!-- Right Section: About Us Text -->
      <div class="col-md-6">
        <h4 class="text-center mb-3">About Us</h4>
        <div id="aboutShort">
          <p>
            At <strong>Nourished by Joy and Grace</strong> we believe that no child should go to school hungry.
          </p>
          <p>
            Our journey began during our Service Based Learning (SBL) program at a public primary school. There, we observed how the school used the Tap2Eat system to provide meals to students. While the initiative was impactful, it had limitations only one meal was offered per day, and many children couldn’t afford even that. It was heartbreaking to see learners struggle with hunger, which directly affected their concentration, energy, and overall well-being.
          </p>
          <button class="btn btn-link p-0" id="readMoreBtn">Read More</button>
        </div>
        <div id="aboutFull" style="display:none;">
          <p>
            This experience inspired us to create a food funding platform that goes beyond basic meal provision. We envisioned a system that not only connects donors directly with needy families but also ensures transparency, tracks donations in real time, and empowers communities to take part in the solution.
          </p>
          <p>
            Our platform supports donors, parents, teachers and community agents, working together to fight food insecurity in schools. Through role-based access and smart integration tools like M-Pesa, we ensure every child has the opportunity to receive consistent and nutritious meals not just once, but throughout their school day.
          </p>
          <p>
            We're committed to accountability, inclusivity, and impact because feeding children isn’t just about food, it’s about feeding hope and opportunity.
          </p>
          <p>
            <strong>Together, we can feed futures.</strong>
          </p>
          <button class="btn btn-link p-0" id="readLessBtn">Read Less</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- =============== IMPACT SECTION =============== -->
<section id="impact" class="ourimpact bg-white">
  <hr>
  <h3 class="text-center my-4">Our Impact</h3>
  <hr>
  <div class="container">
    <div class="row justify-content-center mb-4">
      <div class="col-md-6 d-flex justify-content-center mb-3">
        <div class="card h-100 w-100">
          <div class="card-header bg-light font-weight-bold text-center">School lunch being served</div>
          <div class="card-body d-flex align-items-center justify-content-center" style="min-height:120px;">
            <img src="{% static 'Images/MealsBeingServed.jpg' %}" alt="School lunch being served" class="img-fluid">
          </div>
        </div>
      </div>
      <div class="col-md-6 d-flex justify-content-center mb-3">
        <div class="card h-100 w-100">
          <div class="card-header bg-light font-weight-bold text-center">Children eating the meals</div>
          <div class="card-body d-flex align-items-center justify-content-center" style="min-height:180px;">
            <img src="{%static 'Images/Children_eating_image.webp' %}" alt="Children eating the meals" class="img-fluid" style="max-width:320px; width:100%; height:auto; object-fit:cover;">
          </div>
        </div>
      </div>
    </div>
    <div class="row justify-content-center mb-4">
      <div class="col-md-6 d-flex justify-content-center mb-3">
        <div class="card h-100 w-100">
          <div class="card-header bg-light font-weight-bold text-center">Smiling children after meals</div>
          <div class="card-body d-flex align-items-center justify-content-center" style="min-height:120px;">
            <img src="{%static 'Images/Children_smiling.jpeg' %}" alt="Smiling children after meals" class="img-fluid">
          </div>
        </div>
      </div>
      <div class="col-md-6 d-flex justify-content-center mb-3">
        <div class="card h-100 w-100">
          <div class="card-header bg-light font-weight-bold text-center">Donors serving meals</div>
          <div class="card-body d-flex align-items-center justify-content-center" style="min-height:120px;">
            <img src="{%static 'Images/donor_servingfood.jpeg' %}" alt="Donors serving meals" class="img-fluid">
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- =============== EVENTS TABLE SECTION =============== -->
<div id="events" class="container mt-5 d-flex justify-content-center">
  <div class="w-100" style="max-width:900px;">
    <h3 class="mb-4">Upcoming School Events</h3>
    <div class="table-responsive shadow rounded">
      <table class="table table-striped table-hover align-middle" id="eventsTable">
        <thead class="table-dark">
          <tr>
            <th scope="col">Event Name</th>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
            <th scope="col">Location</th>
            <th scope="col">Description</th>
          </tr>
        </thead>
        <tbody>
          {% for event in events %}
            <tr>
              <td>{{ event.title }}</td>
              <td>{{ event.event_date }}</td>
              <td>{{ event.event_time }}</td>
              <td>{{ event.school.school_name|default:"N/A" }}</td>
              <td>{{ event.description }}</td>

            </tr>
          {% empty %}
            <tr>
              <td colspan="5" class="text-center">No upcoming events.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>


<!-- =============== FEEDBACK SECTION =============== -->
<div class="container d-flex flex-column align-items-center my-4">
  <div class="mb-2 text-center" style="max-width:600px;">
    <h5>We value your feedback!</h5>
    <p>Your thoughts and suggestions help us improve our platform and make a greater impact. Please let us know how we can serve you better.</p>
  </div>
  <a href="{% url 'give_feedback' %}" class="btn rounded-pill" style="background-color:#28a745; color:#fff; font-weight:600; padding:12px 36px; font-size:1.1rem;">Give Feedback</a>
</div>

<!-- =============== SCRIPTS =============== -->
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<script>
  $(document).ready(function() {
    $('#eventsTable').DataTable({
      paging: true,
      searching: true,
      info: true,
      lengthChange: false,
      pageLength: 5,
      columnDefs: [
        { orderable: false, targets: 4 } // Disable sorting on Actions column
      ]
    });
  });
  // Read More/Less functionality for About Us
  $(document).ready(function() {
    $('#readMoreBtn').click(function() {
      $('#aboutShort').hide();
      $('#aboutFull').show();
    });
    $('#readLessBtn').click(function() {
      $('#aboutFull').hide();
      $('#aboutShort').show();
    });
  });
</script>

<!-- =============== FOOTER =============== -->
<footer class="bg-light mt-5 p-3 text-center text-muted">
  &copy; 2025 Nourished by Joy and Grace | Powered by Grace & Joy
</footer>

<!-- Bootstrap JS (for legacy support) -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
